name = 'Thornbite Staff'
cardnum = 145
expansion = 'Morningtide'
type = characteristic('Artifact')
supertype = characteristic('')
subtypes = characteristic(['Equipment', 'Shaman'])
cost = '2'
color = characteristic(['C'])
text = ['Equipped creature has "2, T: This creature deals 1 damage to target creature or player" and "Whenever a creature is put into a graveyard from play, untap this creature."', 'Whenever a Shaman creature comes into play, you may attach Thornbite Staff to it.','Equip 4']

subrole = Equipment()

in_play_role = Permanent(card, subrole)

#################################

subrole.abilities = [EquipAbility(card, "4")]
trigger = EnterTrigger("play", any=True)
subrole.triggered_abilities = [TriggeredAbility(card,
                                      trigger=trigger, 
                                      match_condition=isCreature.with_condition(lambda c: c.subtypes == "Shaman"),
                                      ability=ChoiceAbility(card, cost="0", target=Target(targeting=lambda t=trigger: t.matched_card),
                                                 effects=AttachToPermanent()))]

ability = ActivatedAbility(card, MultipleCosts([ManaCost("2"), TapCost()]), target=Target(target_types=isCreatureOrPlayer), effects=DealDamage(1))
triggered_ability = TriggeredAbility(card,
                                        trigger=EnterFromTrigger(from_zone="play",to_zone="graveyard"),
                                        match_condition = isCreatureType,
                                        ability=Ability(card,
                                                target=Target(targeting="self"),
                                                 effects=UntapTargetPermanent()))

subrole.attached_abilities = [EquipmentStaticAbility(card,
                                        effects=[AddActivatedAbility(ability, expire=False),
						 AddTriggeredAbility(triggered_ability, expire=False)])
]

#################################
